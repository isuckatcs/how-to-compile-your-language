// RUN: compiler %s -ast-dump 2>&1 | filecheck %s
struct Color {
    r: number,
    g: number,
    b: number,
}

fn main(): void {
    let s = Color {r: 0, g: 1, b: 2};
    
    let r = s.r;
    // CHECK: VarDecl: r
    // CHECK-NEXT:   MemberExpr:
    // CHECK-NEXT:     DeclRefExpr: s
    // CHECK-NEXT:     DeclRefExpr: r

    let multipleMembers = s.r.g.b;
    // CHECK: MemberExpr:
    // CHECK-NEXT:   MemberExpr:
    // CHECK-NEXT:     MemberExpr:
    // CHECK-NEXT:       DeclRefExpr: s
    // CHECK-NEXT:       DeclRefExpr: r
    // CHECK-NEXT:     DeclRefExpr: g
    // CHECK-NEXT:   DeclRefExpr: b

    let immediate = Color {r: 0, g: 1, b: 2}.r;
    // CHECK: MemberExpr:
    // CHECK-NEXT:   StructInstantiationExpr
    // CHECK-NEXT:     DeclRefExpr: Color
    // CHECK-NEXT:     FieldInitStmt: r
    // CHECK-NEXT:       NumberLiteral: '0'
    // CHECK-NEXT:     FieldInitStmt: g
    // CHECK-NEXT:       NumberLiteral: '1'
    // CHECK-NEXT:     FieldInitStmt: b
    // CHECK-NEXT:       NumberLiteral: '2'
    // CHECK-NEXT:   DeclRefExpr: r

    let call = f().m.m.m;
    // CHECK: MemberExpr:
    // CHECK-NEXT:   MemberExpr:
    // CHECK-NEXT:     MemberExpr:
    // CHECK-NEXT:       CallExpr:
    // CHECK-NEXT:         DeclRefExpr: f
    // CHECK-NEXT:       DeclRefExpr: m
    // CHECK-NEXT:     DeclRefExpr: m
    // CHECK-NEXT:   DeclRefExpr: m

    s.x.x = 1;
    // CHECK: Assignment:
    // CHECK-NEXT:   MemberExpr:
    // CHECK-NEXT:     MemberExpr:
    // CHECK-NEXT:       DeclRefExpr: s
    // CHECK-NEXT:       DeclRefExpr: x
    // CHECK-NEXT:     DeclRefExpr: x
    // CHECK-NEXT:   NumberLiteral: '1'
}
